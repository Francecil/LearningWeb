---
title: JavaScript执行过程
tags:
---


https://juejin.im/user/5757d748207703006fd9deb2

函数声明和匿名函数表达式不会创建新的变量环境，其变量环境指向函数创建时的变量环境

命名函数表达式会创建一个新的变量环境，新的变量环境 outer 指向旧变量环境，环境记录指向所赋值的变量


闭包：把闭包函数放入了执行调用栈，生成闭包函数的函数在生成闭包函数后就弹出执行栈了，闭包函数内对上层函数的访问其实是对内存中元素的访问，所以生成闭包的函数不能有其他地方的引用，否则会造成垃圾回收无法回收

每个大括号会生成一个词法环境，所以 for 循环中 let 定义的 i 属于每个词法环境的元素

词法环境包括：
- 环境记录
- 对外部的引用

环境记录初始化是在定义时（代码执行前）做的，扫描代码并把变量声明记录到环境记录中

同时初始化的时候会设置外部的引用，指向上一层的词法环境